<div class="card shadow-sm mt-4">
  <div class="card-header bg-light border-bottom d-flex justify-content-between align-items-center">
    <h5 class="mb-0">
      Tasks
      <span class="badge bg-secondary ms-2">{{ project.taskItems.length || 0 }}</span>
    </h5>

    <div class="d-flex align-items-center gap-2">
      <select
        id="taskStatusFilter"
        class="form-select form-select-sm"
        [ngModel]="currentFilter()"
        (ngModelChange)="onStatusFilterChange($event)"
      >
        @for (status of statuses; track status) {
        <option [value]="status">{{ status | statusLabel }}</option>
        }
      </select>

      <button class="btn btn-sm btn-success flex-shrink-0" (click)="createTaskClicked.emit()">
        <i class="bi bi-plus-circle"></i> New Task
      </button>
    </div>
  </div>
  <div class="card-body">
    @if (!project.taskItems || project.taskItems.length === 0) {
    <div class="text-center text-muted py-5">
      <i class="bi bi-list-task" style="font-size: 3rem"></i>
      <p class="mt-3 mb-0">No tasks yet. Create your first task!</p>
    </div>
    } @else {
    <div class="list-group list-group-flush">
      @for (task of project.taskItems; track task.id) {
      <app-task-list-item
        [task]="task"
        [isEditing]="isTaskEditing(task.id)"
        class="list-group-item"
        (editStarted)="editTaskStarted.emit($event)"
        (editCancelled)="editTaskCancelled.emit($event)"
        (saved)="taskSaved.emit($event)"
        (deleteTask)="deleteTaskClicked.emit($event)"
      />
      }
    </div>
    }
  </div>
</div>
