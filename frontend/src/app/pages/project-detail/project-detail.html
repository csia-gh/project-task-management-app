@if (isLoading()) {
<app-loading-spinner message="Loading project..."></app-loading-spinner>
} @else if (project()) {
<!-- Project Card -->
<div class="card shadow-sm">
  <div class="card-header bg-light border-bottom d-flex justify-content-between align-items-center">
    @if (!isEditingProject()) {
    <h3 class="mb-0">{{ project()!.name }}</h3>
    <button class="btn btn-sm btn-outline-primary" (click)="startEditingProject()">
      <i class="bi bi-pencil"></i> Edit
    </button>
    } @else {
    <h3 class="mb-0">Edit Project</h3>
    <div>
      <button class="btn btn-sm btn-success me-2" (click)="saveProject()">
        <i class="bi bi-check-lg"></i> Save
      </button>
      <button class="btn btn-sm btn-secondary" (click)="cancelEditing()">
        <i class="bi bi-x-lg"></i> Cancel
      </button>
    </div>
    }
  </div>
  <div class="card-body">
    @if (!isEditingProject()) {
    <!-- View Mode -->
    <div class="row">
      <div class="col-md-8">
        <h6 class="text-muted">Description</h6>
        <p>{{ project()!.description || 'No description available.' }}</p>
      </div>
      <div class="col-md-4">
        <h6 class="text-muted">Created</h6>
        <p>{{ project()!.createdAt | date : 'mediumDate' }}</p>
      </div>
    </div>
    } @else {
    <!-- Edit Mode -->
    <form #projectFormElement="ngForm">
      <div class="mb-3">
        <label for="projectName" class="form-label">
          Project Name <span class="text-danger">*</span>
        </label>
        <input
          type="text"
          class="form-control"
          id="projectName"
          name="name"
          [(ngModel)]="projectForm.name"
          required
          maxlength="100"
          #nameInput="ngModel"
          [class.is-invalid]="nameInput.invalid && nameInput.touched"
        />
        @if (nameInput.invalid && nameInput.touched) {
        <div class="invalid-feedback d-block">
          @if (nameInput.errors?.['required']) { Project name is required. }
        </div>
        }
      </div>

      <div class="mb-3">
        <label for="projectDescription" class="form-label">Description</label>
        <textarea
          class="form-control"
          id="projectDescription"
          name="description"
          [(ngModel)]="projectForm.description"
          rows="3"
        ></textarea>
      </div>

      <div class="text-muted small">
        <strong>Created:</strong> {{ project()!.createdAt | date : 'mediumDate' }}
      </div>
    </form>
    }
  </div>
</div>

<div class="card shadow-sm mt-4">
  <div class="card-header bg-light border-bottom d-flex justify-content-between align-items-center">
    <h5 class="mb-0">Tasks <span class="badge bg-secondary ms-2">0</span></h5>
    <button class="btn btn-sm btn-success"><i class="bi bi-plus-circle"></i> New Task</button>
  </div>
  <div class="card-body">
    <div class="text-center text-muted py-5">
      <i class="bi bi-list-task" style="font-size: 3rem"></i>
      <p class="mt-3 mb-0">No tasks yet. Create your first task!</p>
    </div>
  </div>
</div>
}
